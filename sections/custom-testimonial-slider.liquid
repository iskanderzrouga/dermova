  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.8.1/slick.min.css"/>
  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.8.1/slick-theme.min.css"/>
 <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.8.1/slick.min.js"></script>

<section class="custom-testimonal {{ section.id }}" style="background:{{ section.settings.section-bg }};">
  <div class="page-width">

    {% if section.settings.heading != blank %}
      <h2 class="custom-testimonal__heading">
        {{ section.settings.heading }}
      </h2>
    {% endif %}

    <div class="custom-testimonal__slider-wrapper">
      <div class="custom-testimonal__slider">

        {% for block in section.blocks %}
          <div class="custom-testimonal__card" {{ block.shopify_attributes }}>

            {% if block.settings.image %}
              <div class="custom-testimonal__image">
                {{ block.settings.image | image_url: width: 700 | image_tag: loading: 'lazy' }}
              </div>
            {% endif %}

            <div class="custom-testimonal__content">

              {% if block.settings.star_image %}
                <div class="custom-testimonal__stars">
                  {{ block.settings.star_image | image_url: width: 120 | image_tag: loading: 'lazy' }}
                </div>
              {% endif %}

              {% if block.settings.title != blank %}
                <h3 class="custom-testimonal__title">
                  {{ block.settings.title }}
                </h3>
              {% endif %}

              {% if block.settings.text != blank %}
                <p class="custom-testimonal__text">
                  {{ block.settings.text }}
                </p>
              {% endif %}

              <div class="custom-testimonal__footer">
                {% if block.settings.name != blank %}
                  <span class="custom-testimonal__name">
                    {{ block.settings.name }}
                  </span>
                {% endif %}

                {% if block.settings.verified %}
                  <span class="custom-testimonal__verified">
                    <svg width="17" height="16" viewBox="0 0 17 16" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M5.7 15.75L4.275 13.35L1.575 12.75L1.8375 9.975L0 7.875L1.8375 5.775L1.575 3L4.275 2.4L5.7 0L8.25 1.0875L10.8 0L12.225 2.4L14.925 3L14.6625 5.775L16.5 7.875L14.6625 9.975L14.925 12.75L12.225 13.35L10.8 15.75L8.25 14.6625L5.7 15.75ZM7.4625 10.5375L11.7 6.3L10.65 5.2125L7.4625 8.4L5.85 6.825L4.8 7.875L7.4625 10.5375Z" fill="#10AF3B"/>
</svg>
 {{ section.settings.verified-buyer-text }}
                  </span>
                {% endif %}
              </div>

            </div>
          </div>
        {% endfor %}

      </div>
    </div>

    {% if section.settings.button_label != blank %}
      <div class="custom-testimonal__button-wrapper">
        <a href="{{ section.settings.button_link }}" class="custom-testimonal__button">
          {{ section.settings.button_label }}
        </a>
      </div>
    {% endif %}

  </div>
</section>

<script>
  (function () {

    function initSlider() {
      var slider = document.querySelector('.{{ section.id }} .custom-testimonal__slider');
      if (!slider || slider.classList.contains('slick-initialized')) return;

      $(slider).slick({
        slidesToShow: 3,
        slidesToScroll: 1,
        arrows: true,
        dots: false,
        infinite: true,
        prevArrow: '<button type="button" class="slick-prev"><svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 60 60" fill="none"><circle cx="30" cy="30" r="30" transform="matrix(-1 0 0 1 60 0)" fill="#39585B"/><path d="M37 19.6725L26.8016 30L37 40.3275L33.8603 43.5L20.5 30L33.8603 16.5L37 19.6725Z" fill="white"/></svg></button>',
        nextArrow: '<button type="button" class="slick-next"><svg xmlns="http://www.w3.org/2000/svg" width="50" height="50" viewBox="0 0 68 68" fill="none"><g filter="url(#filter0_d_2_2207)"><circle cx="34" cy="30" r="30" fill="#39585B"/><path d="M27 19.6725L37.1984 30L27 40.3275L30.1397 43.5L43.5 30L30.1397 16.5L27 19.6725Z" fill="white"/></g></svg></button>',
        responsive: [
          { breakpoint: 990, settings: { slidesToShow: 2 } },
          { breakpoint: 750, settings: { slidesToShow: 1 } }
        ]
      });
    }

    initSlider();
  })();
</script>



<style>

    .custom-testimonal .page-width {
        max-width: 1242px !important;
    }

.{{ section.id }}{
  padding-top: {{ section.settings.padding_top }}px;
  padding-bottom: {{ section.settings.padding_bottom }}px;
}

.{{ section.id }} .custom-testimonal__heading {
  text-align: center;
  font-size: {{ section.settings.heading_size_desktop }}px;
  font-weight: {{ section.settings.heading_weight }};
  margin-bottom: 32px !important;
  max-width: 75%;
  width: 100%;
  margin: auto;
}

/* === PHASE 2: Enhanced Testimonial Cards === */
.{{ section.id }} .custom-testimonal__card {
  background: linear-gradient(180deg, #ffffff 0%, #fafcfc 100%);
  border: none;
  border-radius: 20px;
  overflow: hidden;
  margin: 0 12px;
  box-shadow: 0 4px 16px rgba(57, 88, 91, 0.08), 0 1px 4px rgba(0, 0, 0, 0.04);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

.{{ section.id }} .custom-testimonal__card:hover {
  transform: translateY(-6px);
  box-shadow: 0 12px 32px rgba(57, 88, 91, 0.15), 0 4px 12px rgba(0, 0, 0, 0.08);
}

.{{ section.id }} .custom-testimonal__stars {
    display: flex;
    justify-content: {{ section.settings.align-content }};
}
.{{ section.id }} .custom-testimonal__title, .{{ section.id }} .custom-testimonal__text {
    text-align: {{ section.settings.align-content }};
}

.custom-testimonal__image {
  max-height:275px;
}

.custom-testimonal__image img {
  width: 100%;
  display: block;
  max-height:275px;
}

.custom-testimonal__content {
  padding: 16px;
}

.{{ section.id }} .custom-testimonal__title {
  font-size: {{ section.settings.title_size_desktop }}px;
  font-weight: 600;
  margin: 8px 0;
}

.{{ section.id }} .custom-testimonal__text {
  font-size: {{ section.settings.text_size_desktop }}px;
  line-height: 1.4;
}

.{{ section.id }} .custom-testimonal__footer {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-top: auto;
  font-size: 14px;
}

.{{ section.id }} .custom-testimonal__verified {
  color: #000;
  font-size: 14px;
  display: flex;
  align-items: center;
  gap: 5px;
}

.{{ section.id }} .custom-testimonal__button-wrapper {
  text-align: center;
  margin-top: 32px;
}

/* Enhanced Testimonial CTA Button */
.{{ section.id }} .custom-testimonal__button {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  padding: 18px 28px;
  border-radius: 999px;
  background: linear-gradient(135deg, #39585B 0%, #4a6d70 50%, #39585B 100%);
  background-size: 200% auto;
  color: #fff;
  text-decoration: none;
  width: 100%;
  max-width: 518px;
  font-weight: 600;
  font-size: 18px;
  position: relative;
  overflow: hidden;
  box-shadow: 0 4px 15px rgba(57, 88, 91, 0.25);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

.{{ section.id }} .custom-testimonal__button:hover {
  transform: translateY(-3px);
  box-shadow: 0 8px 25px rgba(57, 88, 91, 0.35);
  background-position: right center;
}

@media (max-width: 749px) {
  .{{ section.id }} .custom-testimonal__heading {
    font-size: {{ section.settings.heading_size_mobile }}px;
  }

  .{{ section.id }} .custom-testimonal__title {
    font-size: {{ section.settings.title_size_mobile }}px;
  }

  .{{ section.id }} .custom-testimonal__text {
    font-size: {{ section.settings.text_size_mobile }}px;
  }
  
  .{{ section.id }} .custom-testimonal__name, .custom-testimonal__verified {
    font-size: 12px;
  }
  .{{ section.id }} .custom-testimonal__verified svg {
    width: 13px;
  }
}


.{{ section.id }} button.slick-arrow:before {
    content: "";
}
.{{ section.id }} button.slick-next.slick-arrow {
    right: -10px;
    z-index: 1;
}
.{{ section.id }} button.slick-prev.slick-arrow {
    left: -37px;
    z-index: 1;
}


/* Equal height slick cards */
.{{ section.id }} .custom-testimonal .slick-track {
  display: flex !important;
}

.{{ section.id }} .custom-testimonal .slick-slide {
  display: flex !important;
  height: auto !important;
}

.{{ section.id }} .custom-testimonal .slick-slide > div {
  display: flex;
  height: 100%;
}

.{{ section.id }} .custom-testimonal__card {
  height: 100%;
  display: flex;
  flex-direction: column;
}

.{{ section.id }} .custom-testimonal__content {
  display: flex;
  flex-direction: column;
  height: 100%;
}

.{{ section.id }} .custom-testimonal__footer {
  margin-top: auto;
}

/* === SLICK EQUAL HEIGHT – FINAL FIX === */
.{{ section.id }} .slick-list {
  display: flex;
}

.{{ section.id }} .slick-track {
  display: flex !important;
  align-items: stretch;
}

.{{ section.id }} .slick-slide {
  display: flex !important;
  height: inherit !important;
}

.{{ section.id }} .slick-slide > div {
  display: flex;
  width: 100%;
}

/* Card fills slide */
.{{ section.id }} .custom-testimonal__card {
  display: flex;
  flex-direction: column;
  height: 100%;
  width: 100%;
  margin-bottom: 8px;
}

/* Content fills remaining space */
.{{ section.id }} .custom-testimonal__content {
  display: flex;
  flex-direction: column;
  flex: 1;
}

/* Footer pinned to bottom */
.{{ section.id }} .custom-testimonal__footer {
  margin-top: auto;
}

@media screen and (max-width:600px){
.{{ section.id }} button.slick-next.slick-arrow {
    right: 15px;
}
.{{ section.id }} button.slick-prev.slick-arrow {
    left: -8px;
}
}



</style>

{% schema %}
{
  "name": "Testimonial Slider",
  "settings": [
    {
        "type": "color",
        "id": "section-bg",
        "default":"#F2F6F6",
        "label": "Section background"
    },
    { "type": "text", "id": "heading", "label": "Section heading" },

    { "type": "range", "id": "heading_size_desktop", "label": "Heading size (desktop)", "min": 18, "max": 56, "step": 1, "default": 32 },
    { "type": "range", "id": "heading_size_mobile", "label": "Heading size (mobile)", "min": 16, "max": 40, "step": 1, "default": 24 },

    {
      "type": "select",
      "id": "heading_weight",
      "label": "Heading weight",
      "options": [
        { "value": "400", "label": "Regular" },
        { "value": "500", "label": "Medium" },
        { "value": "600", "label": "Semi Bold" },
        { "value": "700", "label": "Bold" }
      ],
      "default": "600"
    },

    { "type": "range", "id": "title_size_desktop", "label": "Title size (desktop)", "min": 14, "max": 28, "step": 1, "default": 16 },
    { "type": "range", "id": "title_size_mobile", "label": "Title size (mobile)", "min": 14, "max": 24, "step": 1, "default": 15 },

    { "type": "range", "id": "text_size_desktop", "label": "Text size (desktop)", "min": 12, "max": 22, "step": 1, "default": 14 },
    { "type": "range", "id": "text_size_mobile", "label": "Text size (mobile)", "min": 12, "max": 20, "step": 1, "default": 13 },
    {
        "type": "text_alignment",
        "id": "align-content",
        "default":"center",
        "label": "Align content"
    },
    {
        "type": "text",
        "id": "verified-buyer-text",
        "default":"ผู้ซื้อที่ยืนยันตัวตนแล้ว",
        "label": "Verified buyer text"
    },

    { "type": "text", "id": "button_label", "label": "Button label" },
    { "type": "url", "id": "button_link", "label": "Button link" },

    { "type": "range", "id": "padding_top", "label": "Padding top", "min": 0, "max": 160, "step": 4, "default": 64 },
    { "type": "range", "id": "padding_bottom", "label": "Padding bottom", "min": 0, "max": 160, "step": 4, "default": 64 }
  ],

  "blocks": [
    {
      "type": "testimonial",
      "name": "Testimonial",
      "settings": [
        { "type": "image_picker", "id": "image", "label": "Before / After image" },
        { "type": "image_picker", "id": "star_image", "label": "Star image" },
        { "type": "text", "id": "title", "label": "Testimonial heading" },
        { "type": "textarea", "id": "text", "label": "Testimonial text" },
        { "type": "text", "id": "name", "label": "Customer name" },
        { "type": "checkbox", "id": "verified", "label": "Show verified buyer badge", "default": true }
      ]
    }
  ],

  "presets": [
    { "name": "Testimonial Slider" }
  ]
}
{% endschema %}
